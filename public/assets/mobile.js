(function(){var r=20;var x=0;var F=null;var t=null;var u=0;var k=0;var A=location.hash;var f="#_";var p=[];var m=0;var I;var z=false;var J="portrait";var C="landscape";window.iui={animOn:true,httpHeaders:{"X-Requested-With":"XMLHttpRequest"},showPage:function(L,K){if(L){if(t){t.removeAttribute("selected");q("blur",t);t=null}if(d(L,"dialog")){q("focus",L);y(L)}else{q("load",L);var M=F;q("blur",F);F=L;q("focus",L);if(M){if(K){q("unload",M)}setTimeout(c,0,M,L,K)}else{w(L,M)}}}},showPageById:function(L){var N=o(L);if(N){var M=p.indexOf(L);var K=M!=-1;if(K){p.splice(M)}iui.showPage(N,K)}},goBack:function(){p.pop();var K=p.pop();var L=o(K);iui.showPage(L,true)},showPageByHref:function(L,M,P,O,K){function N(Q){if(Q.readyState==4){var R=document.createElement("div");R.innerHTML=Q.responseText;q("beforeinsert",document.body,{fragment:R});if(O){D(O,R)}else{iui.insertPages(R)}if(K){setTimeout(K,1000,true)}}}iui.ajax(L,M,P,N)},ajax:function(M,L,Q,K){var O=new XMLHttpRequest();Q=Q?Q.toUpperCase():"GET";if(L&&Q=="GET"){M=M+"?"+iui.param(L)}O.open(Q,M,true);if(K){O.onreadystatechange=function(){K(O)}}var N=null;if(L&&Q!="GET"){O.setRequestHeader("Content-Type","application/x-www-form-urlencoded");N=iui.param(L)}for(var P in iui.httpHeaders){O.setRequestHeader(P,iui.httpHeaders[P])}O.send(N)},param:function(M){var L=[];for(var K in M){L[L.length]=encodeURIComponent(K)+"="+encodeURIComponent(M[K])}return L.join("&").replace(/%20/g,"+")},insertPages:function(Q){var L=Q.childNodes;var N;for(var M=0;M<L.length;++M){var P=L[M];if(P.nodeType==1){if(!P.id){P.id="__"+(++m)+"__"}var O=o(P.id);var K;if(O){O.parentNode.replaceChild(P,O);K=o(P.id)}else{K=document.body.appendChild(P)}q("afterinsert",document.body,{insertedNode:K});if(P.getAttribute("selected")=="true"||!N){N=P}--M}}if(N){iui.showPage(N)}},getSelectedPage:function(){for(var K=document.body.firstChild;K;K=K.nextSibling){if(K.nodeType==1&&K.getAttribute("selected")=="true"){return K}}},isNativeUrl:function(K){for(var L=0;L<iui.nativeUrlPatterns.length;L++){if(K.match(iui.nativeUrlPatterns[L])){return true}}return false},nativeUrlPatterns:[new RegExp("^http://maps.google.com/maps?"),new RegExp("^mailto:"),new RegExp("^tel:"),new RegExp("^http://www.youtube.com/watch\\?v="),new RegExp("^http://www.youtube.com/v/"),new RegExp("^javascript:"),],hasClass:function(K,L){var M=new RegExp("(^|\\s)"+L+"($|\\s)");return M.exec(K.getAttribute("class"))!=null},addClass:function(K,L){if(!iui.hasClass(K,L)){K.className+=" "+L}},removeClass:function(K,L){if(iui.hasClass(K,L)){var M=new RegExp("(\\s|^)"+L+"(\\s|$)");K.className=K.className.replace(M," ")}}};addEventListener("load",function(L){var M=iui.getSelectedPage();var K=E();if(M){iui.showPage(M)}if(K&&(K!=M)){iui.showPage(K)}setTimeout(s,0);if(typeof window.onorientationchange=="object"){window.onorientationchange=j;z=true;setTimeout(j,0)}setTimeout(h,0);I=setInterval(h,300)},false);addEventListener("unload",function(K){return},false);addEventListener("click",function(N){var M=a(N.target,"a");if(M){function K(){M.removeAttribute("selected")}if(M.href&&M.hash&&M.hash!="#"&&!M.target){M.setAttribute("selected","true");iui.showPage(o(M.hash.substr(1)));setTimeout(K,500)}else{if(M==o("backButton")){iui.goBack()}else{if(M.getAttribute("type")=="submit"){var L=a(M,"form");if(L.target=="_self"){L.submit();return}v(L)}else{if(M.getAttribute("type")=="cancel"){g(a(M,"form"))}else{if(M.target=="_replace"){M.setAttribute("selected","progress");iui.showPageByHref(M.href,null,"GET",M,K)}else{if(iui.isNativeUrl(M.href)){return}else{if(M.target=="_webapp"){location.href=M.href}else{if(!M.target){M.setAttribute("selected","progress");iui.showPageByHref(M.href,null,"GET",null,K)}else{return}}}}}}}}N.preventDefault()}},true);addEventListener("click",function(K){var L=a(K.target,"div");if(L&&d(L,"toggle")){L.setAttribute("toggled",L.getAttribute("toggled")!="true");K.preventDefault()}},true);function q(L,N,K){if(N){var M=document.createEvent("UIEvent");M.initEvent(L,false,false);if(K){for(i in K){M[i]=K[i]}}N.dispatchEvent(M)}}function E(){var L;var K=location.hash.match(/#_([^\?_]+)/);if(K){L=K[1]}if(L){L=o(L)}return L}function j(){var K=window.orientation;switch(K){case 0:G(J);break;case 90:case -90:G(C);break}}function h(){if(!z){if((window.innerWidth!=u)||(window.innerHeight!=k)){u=window.innerWidth;k=window.innerHeight;var L=(u<k)?J:C;G(L)}}if(location.hash!=A){var K=location.hash.substr(f.length);iui.showPageById(K)}}function G(K){document.body.setAttribute("orient",K);if(K==J){iui.removeClass(document.body,C);iui.addClass(document.body,J)}else{if(K==C){iui.removeClass(document.body,J);iui.addClass(document.body,C)}else{iui.removeClass(document.body,J);iui.removeClass(document.body,C)}}setTimeout(scrollTo,100,0,1)}function y(K){t=K;K.setAttribute("selected","true");if(d(K,"dialog")){B(K)}}function B(K){K.onsubmit=function(L){L.preventDefault();v(K)};K.onclick=function(L){if(L.target==K&&d(K,"dialog")){g(K)}}}function g(K){K.removeAttribute("selected")}function w(P,Q){if(!P.id){P.id="__"+(++m)+"__"}location.hash=A=f+P.id;p.push(P.id);var O=o("pageTitle");if(P.title){O.innerHTML=P.title}var L=P.getAttribute("ttlclass");O.className=L?L:"";if(P.localName.toLowerCase()=="form"&&!P.target){B(P)}var M=o("backButton");if(M){var K=o(p[p.length-2]);if(K&&!P.getAttribute("hideBackButton")){M.style.display="inline";M.innerHTML=K.title?K.title:"Back";var N=K.getAttribute("bbclass");M.className=(N)?"button "+N:"button"}else{M.style.display="none"}}}function c(O,N,L){var M=(L?O:N).getAttribute("axis");clearInterval(I);q("beforetransition",O,{out:true});q("beforetransition",N,{out:false});if(l()&&M!="y"){b(O,N,L,K)}else{e(O,N,L,M,K)}function K(){if(!d(N,"dialog")){O.removeAttribute("selected")}I=setInterval(h,300);setTimeout(w,0,N,O);O.removeEventListener("webkitTransitionEnd",K,false);q("aftertransition",O,{out:true});q("aftertransition",N,{out:false})}}function l(){return(iui.animOn)&&(typeof WebKitCSSMatrix=="object")}function e(Q,P,M,N,L){if(N=="y"){(M?Q:P).style.top="100%"}else{P.style.left="100%"}scrollTo(0,1);P.setAttribute("selected","true");q("selected",P);var O=100;K();var R=setInterval(K,x);function K(){O-=r;if(O<=0){O=0;clearInterval(R);L()}if(N=="y"){M?Q.style.top=(100-O)+"%":P.style.top=O+"%"}else{Q.style.left=(M?(100-O):(O-100))+"%";P.style.left=(M?-O:O)+"%"}}}function b(P,O,L,K){O.style.webkitTransitionDuration="0ms";var M="translateX("+(L?"-":"")+window.innerWidth+"px)";var N="translateX("+(L?"100%":"-100%")+")";O.style.webkitTransform=M;O.setAttribute("selected","true");O.style.webkitTransitionDuration="";function Q(){P.style.webkitTransform=N;O.style.webkitTransform="translateX(0%)"}P.addEventListener("webkitTransitionEnd",K,false);setTimeout(Q,0)}function s(){var K=document.createElement("div");K.id="preloader";document.body.appendChild(K)}function v(L){iui.addClass(L,"progress");iui.showPageByHref(L.action,H(L),L.method||"GET",null,K);function K(){iui.removeClass(L,"progress")}}function H(M){function L(N){for(var O=0;O<N.length;++O){if(N[O].name){K[N[O].name]=N[O].value}}}var K={};L(M.getElementsByTagName("input"));L(M.getElementsByTagName("textarea"));L(M.getElementsByTagName("select"));L(M.getElementsByTagName("button"));return K}function a(L,K){while(L&&(L.nodeType!=1||L.localName.toLowerCase()!=K)){L=L.parentNode}return L}function d(K,L){return iui.hasClass(K,L)}function D(L,O){var N=L.parentNode;var M=L;while(N.parentNode!=document.body){N=N.parentNode;M=M.parentNode}N.removeChild(M);var K;while(O.firstChild){K=N.appendChild(O.firstChild);q("afterinsert",document.body,{insertedNode:K})}}function o(K){return document.getElementById(K)}function n(){console.log.apply(console,arguments)}})();$.WorldBank={};$.WorldBank.TheMap=function(){var a;var c;function g(){c=new google.maps.LatLng(40,14);if(navigator&&navigator.geolocation){navigator.geolocation.getCurrentPosition(d,e)}}function d(k){c=new google.maps.LatLng(k.coords.latitude,k.coords.longitude);if(a){a.setCenter(c)}}function e(){}function b(){a=new google.maps.Map(document.getElementById("map"),{center:c,mapTypeId:google.maps.MapTypeId.TERRAIN,zoom:4,streetViewControl:false,mapTypeControl:false,panControl:false,zoomControl:false,disableDefaultUI:true,maxZoom:6})}function h(){$("#MapContainer").one("selected",f);$(window).resize(function(){google.maps.event.trigger(a,"resize")});$("#Navigation div.option").click(function(){$.WorldBank.Country.changeData(this)});$("#view_undisbursed_loans").click(function(){$("#undisbursed_percent").trigger("click")});$("#view_disbursed_loans").click(function(){$("#disbursed_percent").trigger("click")})}function f(){google.maps.event.trigger(a,"resize");a.setCenter(c)}var j={initialize:function(){$.WorldBank.CountryOverlay.prototype=new google.maps.OverlayView;g();b();h()},getMap:function(){return a}};return j}();$(document).ready(function(){$("body").append('<script src="http://maps.google.com/maps/api/js?sensor=true&callback=$.WorldBank.TheMap.initialize" type="text/javascript"><\/script>')});$.WorldBank.CountryOverlay=(function(){return function(a){var b=a;var c;this.onAdd=function(){var d=this.getPanes().floatPane;c=$('<div class="country-overlay">'+b.getOverlayText()+"</div>");$(c).click(function(){b.clicked()});$(d).append(c)};this.onRemove=function(){$(c).remove()};this.draw=function(){c.removeClass("zoom-0 zoom-1 zoom-2 zoom-3 zoom-4 zoom-5 zoom-6");c.addClass("zoom-"+b.getMarker().getMap().getZoom());c.removeClass("size-0 size-1 size-2 size-3");c.addClass("size-"+Math.round(b.getMarkerSizeFactor()*3));var e=this.getProjection();var d=e.fromLatLngToDivPixel(b.getLatLng());c.css("left",d.x-c.width()/2);c.css("top",d.y-c.height()/2)};this.update=function(){c.html(b.getOverlayText());this.draw()};this.setMap(b.getMarker().getMap())}})();$.WorldBank.Country=(function(){var a=[1,10,30,40,60,90,100];var b=[10,10,14,20,28,34,40];return function(j){var d;var f;var j;var g;var e=this;var c=function(){if(g==null||g!=d.getMap().getZoom()){g=d.getMap().getZoom();return true}else{return false}};var h=function(){var l=e.getMarkerSizeFactor();if(l<0){l=0}var m=Math.round(a[g]*l+b[g]);var k=Math.round(m/2);d.setIcon(new google.maps.MarkerImage(e.getMarkerImageUrl(),new google.maps.Size(m,m),new google.maps.Point(0,0),new google.maps.Point(k,k),new google.maps.Size(m,m)));d.setShape({type:"circle",coords:[k,k,k*0.6]});d.setZIndex(Math.round(1-l*100))};this.getMarkerImageUrl=function(){return j.marker_image_url};this.clicked=function(k){window.iui.showPageByHref(e.getLink())};this.getMarker=function(){return d};this.getLatitude=function(){return j.latitude};this.getLongitude=function(){return j.longitude};this.getLatLng=function(){return new google.maps.LatLng(this.getLatitude(),this.getLongitude())};this.update=function(k){var l=d.getMap();d.setMap(null);j=k;h();d.setMap(l);f.update()};this.getMarkerSizeFactor=function(){return j.size_factor};this.getLink=function(){return j.link};this.getOverlayText=function(){return j.overlay_text};$.WorldBank.Country.countries[j.name]=this;this.data=j;d=new google.maps.Marker({position:new google.maps.LatLng(this.getLatitude(),this.getLongitude()),title:j.name,flat:true,clickable:false,icon:null});d.setMap($.WorldBank.TheMap.getMap());d.country=this;google.maps.event.addListener(d,"click",this.clicked);f=new $.WorldBank.CountryOverlay(this);google.maps.event.addListener(d.getMap(),"idle",function(k){if(c()){if(g==0){d.getMap().setZoom(1)}h()}})}})();$.WorldBank.Country.countries=[];$.WorldBank.Country.data_property;$.WorldBank.Country.create_or_update=function(b){if(b==null||b.error){return null}if(b instanceof Array){for(var a in b){$.WorldBank.Country.create_or_update(b[a])}}else{if(this.exists(b)){this.update(b)}else{this.create(b)}}};$.WorldBank.Country.create=function(a){var b=new $.WorldBank.Country(a);this.countries.push(b);return b};$.WorldBank.Country.update=function(a){var b=this.countries[a.name];b.update(a)};$.WorldBank.Country.exists=function(a){if(this.countries[a.name]){return true}else{return false}};$.WorldBank.Country.changeData=function(a){$("#Navigation .option").removeAttr("selected");$(a).attr("selected","progress");if(a.id!=this.data_property){this.data_property=a.id;$.getJSON("/country_data/"+this.data_property,function(b){$(a).attr("selected",true);$.WorldBank.Country.create_or_update(b);google.maps.event.trigger($.WorldBank.TheMap.getMap(),"idle")})}};